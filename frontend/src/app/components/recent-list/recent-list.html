<section class="container mx-auto p-4 max-w-full py-8">
  <h2 class="font-roboto font-semibold text-2xl tracking-wide mb-6">NOWOÅšCI</h2>

  @if (isLoading) {
    <div class="flex flex-col lg:flex-row gap-4 w-full justify-center">
      <div>
        <div class="w-full max-w-[400px] mx-auto lg:mx-0 pb-3">
          <span class="bg-[var(--base-blue-darker)] text-white text-2xl font-base px-4 py-1">
            Polecane
          </span>
        </div>
        <div
          class="w-full max-w-[400px] h-[600px] overflow-hidden shadow-lg mx-auto lg:mx-0 bg-gray-200 animate-pulse"
        ></div>
      </div>
      <div class="w-full lg:w-auto md:pt-2">
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 lg:pt-9">
          @for (i of [1, 2, 3, 4, 5, 6]; track i) {
            <div
              class="overflow-hidden shadow-lg h-[292px] w-[195px] justify-self-center bg-gray-200 animate-pulse"
            ></div>
          }
        </div>
      </div>
    </div>
  } @else {
    <div class="flex flex-col lg:flex-row gap-4 w-full justify-center">
      @if (featuredBook) {
        <div>
          <div class="w-full max-w-[400px] mx-auto lg:mx-0 pb-3">
            <span class="bg-[var(--base-blue-darker)] text-white text-2xl font-base px-4 py-1">
              Polecane
            </span>
          </div>

          <div
            class="w-[400px] h-[600px] overflow-hidden shadow-lg mx-auto lg:mx-0 relative bg-gray-200"
          >
            @if (featuredImageLoading) {
              <div
                class="absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center"
              >
                <svg
                  class="w-16 h-16 text-gray-400"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                  ></path>
                </svg>
              </div>
            }
            <img
              [ngSrc]="getImageUrl(featuredBook)"
              [alt]="featuredBook.title"
              fill
              priority
              class="object-cover"
              (load)="handleFeaturedLoad()"
              (error)="handleFeaturedError($event)"
            />
          </div>
        </div>
      }

      <div class="w-full lg:w-auto md:pt-2">
        <div class="grid grid-cols-2 md:grid-cols-3 gap-4 lg:pt-9">
          @for (book of gridBooks; track book.id) {
            <div
              class="overflow-hidden shadow-lg h-[292px] justify-self-center relative aspect-[2/3] bg-gray-200"
            >
              @if (isGridImageLoading(book.id)) {
                <div
                  class="absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center"
                >
                  <svg
                    class="w-10 h-10 text-gray-400"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                    ></path>
                  </svg>
                </div>
              }
              <img
                [ngSrc]="getImageUrl(book)"
                [alt]="book.title"
                fill
                loading="lazy"
                class="object-cover"
                (load)="handleGridImageLoad(book.id)"
                (error)="handleGridImageError($event, book)"
              />
            </div>
          }
        </div>
      </div>
    </div>
  }
</section>
