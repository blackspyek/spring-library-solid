<div class="px-4 sm:px-6 lg:px-5 space-y-4 pt-4 pb-32 md:py-10">
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
    <div
      class="bg-[color:var(--book-bg)] rounded-xl shadow-md p-4 flex flex-col sm:flex-row justify-between items-start w-full"
    >
      <div class="w-full flex-grow h-full flex flex-col">
        <h2
          class="border-b border-[color:var(--base-separator)] text-lg font-bold text-[color:var(--base-gray-darker)] mb-3 pb-2 flex items-center"
        >
          <span class="mr-2 text-[color:var(--delete-red)]"
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              height="24px"
              viewBox="0 -960 960 960"
              width="24px"
              fill="var(--base-gray-darker)"
            >
              <path
                d="M880-720v480q0 33-23.5 56.5T800-160H160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720Zm-720 80h640v-80H160v80Zm0 160v240h640v-240H160Zm0 240v-480 480Z"
              /></svg
          ></span>
          Twoja Karta Czytelnika
        </h2>

        <div class="flex flex-col sm:flex-row flex-grow items-stretch justify-between gap-4">
          <app-profile-card class="flex-grow"></app-profile-card>
          <app-qr-code></app-qr-code>
        </div>
      </div>
    </div>
    <div class="bg-[color:var(--book-bg)] rounded-xl shadow-md p-4 w-full">
      <h2
        class="border-b border-[color:var(--base-separator)] text-lg font-bold text-[color:var(--base-gray-darker)] mb-3 pb-2 flex items-center"
      >
        <span class="mr-2 text-[color:var(--delete-red)]"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="var(--base-gray-darker)"
          >
            <path
              d="M120-120v-560h160v-160h400v320h160v400H520v-160h-80v160H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 480h80v-80h-80v80Zm0-160h80v-80h-80v80Z"
            /></svg
        ></span>
        Twoja biblioteka
      </h2>

      @if (isLoadingBranch()) {
        <div class="flex items-center justify-center py-4">
          <mat-spinner diameter="32"></mat-spinner>
        </div>
      } @else if (favouriteBranch()) {
        <app-library-details
          [libraryName]="libraryDisplayName()"
          [libraryAddress]="libraryDisplayAddress()"
          [openingDays]="openingDays()"
          [openingHours]="openingHoursList()"
          (changeLibrary)="openLibrarySelectorDialog()"
        ></app-library-details>
      } @else {
        <div
          class="bg-[color:var(--base-gray-light)] rounded-lg p-4 border border-[color:var(--base-border-gray)] flex flex-col items-center justify-center gap-3"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            height="36px"
            viewBox="0 -960 960 960"
            width="36px"
            fill="var(--base-gray-lighter)"
          >
            <path
              d="M120-120v-560h160v-160h400v320h160v400H520v-160h-80v160H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 480h80v-80h-80v80Zm0-160h80v-80h-80v80Z"
            />
          </svg>
          <p class="text-[color:var(--base-gray-lighter)] text-center">
            Nie masz jeszcze wybranej biblioteki.<br />Wybierz swoją ulubioną filię, aby ułatwić
            sobie korzystanie z usług.
          </p>
          <button
            (click)="openLibrarySelectorDialog()"
            class="bg-[color:var(--base-blue-lighter)] hover:bg-[color:var(--base-blue-darker)] text-[color:var(--base-white)] text-sm py-2 px-6 rounded-lg transition duration-150 cursor-pointer"
          >
            Wybierz bibliotekę
          </button>
        </div>
      }

      <h3
        class="border-b border-[color:var(--base-separator)] text-base font-bold text-[color:var(--base-gray-darker)] mb-2 mt-3 pb-1"
      >
        Ustawienia i Powiadomienia
      </h3>
      <!-- <div class="border-b border-[color:var(--base-separator)] flex justify-between items-center">
        <p class="font-light text-sm text-[color:var(--base-gray-darker)]">
          Preferencje powiadomień
        </p>
        <button
          class="bg-[color:var(--edit-button-bg)] hover:bg-[color:var(--edit-button-hover)] text-[color:var(--white-to-yellow)] text-sm py-1 px-3 rounded-lg transition duration-150 mb-2 cursor-pointer"
          (click)="openNotificationSettingsDialog()"
        >
          Edytuj
        </button>
      </div> -->
      <div class="flex justify-between items-center">
        <p class="font-light text-[color:var(--base-gray-darker)]">Zmiana hasła</p>
        <button
          class="bg-[color:var(--edit-button-bg)] hover:bg-[color:var(--edit-button-hover)] text-[color:var(--white-to-yellow)] text-sm py-1 px-3 rounded-lg transition duration-150 mb-2 cursor-pointer"
          (click)="openPasswordChangeDialog()"
        >
          Edytuj
        </button>
      </div>
    </div>
  </div>
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
    <div class="bg-[color:var(--book-bg)] rounded-xl shadow-md p-4 w-full">
      <h2
        class="border-b border-[color:var(--base-separator)] text-lg font-bold text-[color:var(--base-gray-darker)] mb-3 pb-2 flex items-center"
      >
        <span class="mr-2 text-[color:var(--delete-red)]"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="var(--base-gray-darker)"
          >
            <path
              d="M480-240q100 0 170-70t70-170q0-100-70-170t-170-70v240L310-310q35 33 78.5 51.5T480-240Zm0 160q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"
            /></svg
        ></span>
        Twoje rezerwacje
      </h2>
      <app-user-reservations-container></app-user-reservations-container>
    </div>

    <div class="bg-[color:var(--book-bg)] rounded-xl shadow-md p-4 w-full">
      <h2
        class="border-b border-[color:var(--base-separator)] text-lg font-bold text-[color:var(--base-gray-darker)] mb-3 pb-2 flex items-center"
      >
        <span class="mr-2 text-[color:var(--delete-red)]"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="var(--base-gray-darker)"
          >
            <path
              d="m344-60-76-128-144-32 14-148-98-112 98-112-14-148 144-32 76-128 136 58 136-58 76 128 144 32-14 148 98 112-98 112 14 148-144 32-76 128-136-58-136 58Zm34-102 102-44 104 44 56-96 110-26-10-112 74-84-74-86 10-112-110-24-58-96-102 44-104-44-56 96-110 24 10 112-74 86 74 84-10 114 110 24 58 96Zm102-318Zm-42 142 226-226-56-58-170 170-86-84-56 56 142 142Z"
            /></svg
        ></span>
        Twoje wypożyczenia
      </h2>
      <app-user-rentals-container></app-user-rentals-container>
    </div>
  </div>
  <div class="bg-[color:var(--book-bg)] rounded-xl shadow-md p-4 w-full">
    <div
      class="flex justify-between items-center border-b border-[color:var(--base-separator)] mb-3 pb-2"
    >
      <h2 class="text-lg font-bold text-[color:var(--base-gray-darker)] flex items-center">
        <span class="mr-2 text-gray-500"
          ><svg
            xmlns="http://www.w3.org/2000/svg"
            height="24px"
            viewBox="0 -960 960 960"
            width="24px"
            fill="var(--base-gray-darker)"
          >
            <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" /></svg
        ></span>
        Ostatnie wypożyczenia
      </h2>
      <button
        (click)="downloadHistory()"
        [disabled]="isExportingHistory()"
        class="bg-[color:var(--edit-button-bg)] hover:bg-[color:var(--edit-button-bg)] text-[color:var(--white-to-yellow)] text-sm py-2 px-4 rounded-lg transition duration-150 whitespace-nowrap disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer"
      >
        {{ isExportingHistory() ? 'Pobieranie...' : 'Pobierz całą historię' }}
      </button>
    </div>
    <app-recent-rentals-list></app-recent-rentals-list>
  </div>
</div>
